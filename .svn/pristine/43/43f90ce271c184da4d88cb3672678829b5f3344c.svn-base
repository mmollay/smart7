<?php
include (__DIR__ . '/../config.php'); // Stellen Sie sicher, dass die Datenbankkonfiguration hier korrekt inkludiert wird

// Überprüfen, ob die Anfrage eine POST-Anfrage ist
if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset ($_SESSION['client_id'])) {
    $clientId = $_SESSION['client_id'];

    // POST-Variablen sanitizen und zuweisen
    $firstName = $db->real_escape_string($_POST['first_name']);
    $lastName = $db->real_escape_string($_POST['last_name']);
    $phone = $db->real_escape_string($_POST['phone']);
    $street = $db->real_escape_string($_POST['street']);
    $zip = $db->real_escape_string($_POST['zip']);
    $country = $db->real_escape_string($_POST['country']);
    $company = $db->real_escape_string($_POST['company']);
    // Weiterführende Daten...

    // SQL-Befehl vorbereiten für das Update
    $sql = "UPDATE clients SET first_name=?, last_name=?, phone=?, street=?, zip=?, country=?, company=? WHERE client_id=?";

    if ($stmt = $db->prepare($sql)) {
        // Parameter binden und Ausführen
        $stmt->bind_param("sssssssi", $firstName, $lastName, $phone, $street, $zip, $country, $company, $clientId);

        if ($stmt->execute()) {
            echo json_encode(['success' => true, 'message' => 'Daten erfolgreich aktualisiert.']);
        } else {
            echo json_encode(['success' => false, 'message' => 'Fehler beim Aktualisieren der Daten.']);
        }

        $stmt->close();
    } else {
        echo json_encode(['success' => false, 'message' => 'Fehler bei der Vorbereitung der Anfrage.']);
    }
} else {
    echo json_encode(['success' => false, 'message' => 'Ungültige Anfrage oder keine Benutzer-ID verfügbar.']);
}

$db->close();
?>